# 后端服务启动说明

## 数据库配置

### MySQL 连接信息
- **主机**: localhost
- **端口**: 3305
- **用户名**: root
- **密码**: syj17771493975
- **数据库名**: competition_system（自动创建）

## 安装步骤

### 1. 安装依赖
```bash
cd backend
npm install
```

### 2. 确保 MySQL 服务运行
请确保 MySQL 服务在端口 3305 上运行。

### 3. 启动后端服务
```bash
npm start
```

或使用开发模式（自动重启）：
```bash
npm run dev
```

## 验证

### 1. 检查服务状态
打开浏览器访问：
```
http://localhost:3001/api/health
```

应该看到：
```json
{
  "status": "ok",
  "message": "服务运行正常"
}
```

### 2. 数据库表结构
服务启动时会自动创建以下表：

- **contests** - 赛事基础信息表
- **contest_budget** - 赛事预算表
- **contest_venues** - 赛事场地表
- **contest_personnel** - 赛事人员表
- **contest_equipment** - 赛事设备表
- **contest_materials** - 赛事物资表

## API 端点

### 创建赛事
- **URL**: POST `/api/contests`
- **描述**: 创建新赛事并保存到数据库
- **请求体**: 
```json
{
  "basicInfo": {
    "name": "赛事名称",
    "type": "algorithm",
    "timeAndPlace": { ... },
    "incentives": { ... },
    "rules": "规则说明"
  },
  "resourceConfig": {
    "budget": { ... },
    "venue": [ ... ],
    "personnel": { ... },
    "equipment": [ ... ],
    "materials": [ ... ]
  }
}
```

### 获取所有赛事
- **URL**: GET `/api/contests`
- **描述**: 获取所有赛事列表

### 获取单个赛事
- **URL**: GET `/api/contests/:id`
- **描述**: 获取指定ID的赛事详情

## 前端配置

前端已配置为连接 `http://localhost:3001` 后端服务。

确保：
1. 前端运行在 `http://localhost:3000`
2. 后端运行在 `http://localhost:3001`
3. CORS 已启用，允许跨域请求

## 测试流程

1. 启动 MySQL 数据库（端口 3305）
2. 启动后端服务：`npm start`
3. 启动前端服务（在根目录）：`npm start`
4. 访问 `http://localhost:3000`
5. 创建新赛事并提交
6. 查看控制台日志确认数据已保存

## 常见问题

### Q: 连接数据库失败？
A: 请检查：
- MySQL 服务是否运行
- 端口是否为 3305
- 密码是否正确
- 防火墙设置

### Q: 提交失败？
A: 请检查：
- 后端服务是否启动
- 浏览器控制台是否有错误
- 网络请求是否成功

### Q: 数据库表未创建？
A: 服务启动时会自动创建。如果失败，请检查数据库权限。

## 调试

### 查看后端日志
```bash
# 后端控制台会显示：
✅ 数据库已创建或已存在
✅ 数据表已创建
✅ 数据库连接成功
🚀 服务器运行在 http://localhost:3001
📊 数据库端口: 3305
```

### 查看数据库
使用 MySQL 客户端连接并查看：
```sql
USE competition_system;
SHOW TABLES;
SELECT * FROM contests;
```

## 生产环境部署

生产环境需要修改：
1. 数据库密码（使用环境变量）
2. CORS 配置（限制允许的域名）
3. 添加身份验证
4. 使用 HTTPS
5. 添加日志系统
